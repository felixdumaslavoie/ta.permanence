---

import { getLangFromUrl, useTranslations } from "../i18n/utils";

import { ROUTES_ARCHIVES_CUTE } from "../consts";

import ThemeIcon from "./ThemeIcon.astro";
import SearchModal from "./SearchModal.astro";
import LangageSwitcher from "./LangageSwitcher.astro";

interface Props {
  numeroPage: String;
}

const { numeroPage } = Astro.props;

const { pathname } = Astro.url;


const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
let routeArchives = ROUTES_ARCHIVES_CUTE[lang];
---

<div class="drawer drawer-end sm:hidden z-10 flex justify-end">
  <input id="my-drawer-4" type="checkbox" class="drawer-toggle" />
  <div class="drawer-content">
    <!-- Page content here -->
    <label for="my-drawer-4" class="drawer-button relative z-10">
      <div class="tham tham-e-arrow tham-w-6">
        <div class="tham-box">
          <div class="tham-inner"></div>
        </div>
      </div>
    </label>
  </div>
  <div class="drawer-side">
    <label
      for="my-drawer-4"
      aria-label="close sidebar"
      class="drawer-overlay tgt"></label>
    <ul
      class="menu bg-base-200 text-base-content min-h-full w-80 p-4 [&>li]:w-9/12"
    >
      <!-- Sidebar content here -->
      <li>
        <button class="btn btn-circle btn-outline tgt">
          <label
            for="my-drawer-4"
            aria-label="close sidebar"
            class="drawer-overlay absolute w-12 h-full"></label>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </li>
      <li class="mt-8"><a href="">{t("nav.home")}</a></li>
        <li class="pt-1">
    <a class="display_flex w-[8rem]" href={t("link.about")}>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-5 w-5"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      <p class="m-0">{t("nav.about")}</p>
    </a>
  </li>
      <li class="archivesLink z-10 pt-[0.6rem]">
        <details class="archivesLinkDetails">
          <summary class="archivesLinkSummary">Archives</summary>
          <ul>
            <li><a href={`${routeArchives}`}>{t("lesCUTE")}</a></li>
          </ul>
        </details>
      </li>

      <!--<li><SearchModal></SearchModal></li> -->
      <li><SearchModal searchBarId="mobileSearchBar" /></li>
      <li><ThemeIcon /></li>
      <li class="doIt"><LangageSwitcher numeroPage={numeroPage}  /></li>
    </ul>
  </div>
</div>

<style>
  .drawer {
    width: auto;
  }

  a.display_flex {
    display: flex;
  }

  a {
    display: inline-block;
    text-decoration: none;
  }
  a.active {
    font-weight: bolder;
    text-decoration: underline;
  }
</style>
<script>
  const tham = document.querySelector(".tham");

  if (tham !== null)
    tham.addEventListener("click", () => {
      tham.classList.toggle("tham-active");
    });

  const tgt = document.querySelectorAll(".tgt");
  if (tgt !== null)
    tgt.forEach((elem) => {
      elem.addEventListener("click", () => {
        if (tham !== null) tham.classList.remove("tham-active");
      });
    });
</script>
