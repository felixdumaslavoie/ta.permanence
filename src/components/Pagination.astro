---
import { getLangFromUrl, howManyMainPages } from "../i18n/utils";
const { numeroPage } = Astro.props;

const lang = getLangFromUrl(Astro.url);

const howManyPages = howManyMainPages(lang);

const no = Number(numeroPage);

const noMinusOne = no - 1 > 0 ? no - 1 : 0;

const noPlusOne = no + 1 < howManyPages ? no + 1 : howManyPages - 1;

const latestPage = howManyPages - 1;

const isFirst = no === 0 ? " btn-disabled " : " ";

const isLast = no === latestPage ? " btn-disabled " : " ";
---

<astro-pagination data-nopage={numeroPage}>
    <div class="join flex justify-center">
        <button class=`join-item btn ${isFirst}`
            ><a href=`/${lang}/0`>Main page</a></button
        >
        <button class=`join-item btn ${isFirst}`
            ><a href={`/${lang}/${noMinusOne}`}>«</a></button
        >
        <button class="join-item btn btn-disabled">{no + 1}</button>
        <button class=`join-item btn ${isLast}`
            ><a href={`/${lang}/${noPlusOne}`}>»</a></button
        >
        <button class=`join-item btn ${isLast}`
            ><a href={`/${lang}/${latestPage}`}>Last page</a></button
        >
    </div>
</astro-pagination>
<style>
    .languageSwitcher {
        display: block;
    }
</style>

<script>
    class AstroPagination extends HTMLElement {
        constructor() {
            super();

            /*buttons.forEach((input: HTMLInputElement) => {
                input.checked = false;
            });

            // Read the message from the data attribute.
            const lang = this.dataset.message;
            const translationURL = this.dataset.translation;
            const noPage = this.dataset.nopage;

            const input = this.querySelector("input");
            if (input !== null) {
                input.addEventListener("click", () => {
                    if (translationURL) {
                        console.log(translationURL);
                        window.location.replace(translationURL);
                    }
                });
            }*/
        }
    }

    // Find all buttons with the `alert` class on the page.
    const buttons = document.querySelectorAll("div.join");
    customElements.define("astro-pagination", AstroPagination);
</script>
